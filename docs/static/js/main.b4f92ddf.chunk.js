(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports=a(18)},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),i=a(8),o=a.n(i),s=(a(17),a(10)),l=a(1),u=a(2),p=a(5),m=a(3),h=a(6),d=a(4),f=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"header__container"},c.a.createElement("div",{className:"header__logo"},c.a.createElement("h1",{className:"header__logo-title"},"Spot",c.a.createElement("span",null,"A"),"Room"),c.a.createElement("span",{className:"header__logo-subtitle"},"The best way to find your home")),c.a.createElement("nav",{className:"header__nav"},c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("a",{href:"#"},"The company")),c.a.createElement("li",null,c.a.createElement("a",{href:"#"},"How we work")),c.a.createElement("li",null,c.a.createElement("a",{href:"#"},"Contact us"))))))}}]),t}(r.Component),b=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSelectPrice,a=e.sortPriceValue,n=e.handleSelectType,r=e.typeToFilter;return c.a.createElement("div",{className:"main__filters"},c.a.createElement("h2",{className:"main__filters-title"},"Filters:"),c.a.createElement("h3",{className:"main__filters-subtitle"},"Property type:"),c.a.createElement("select",{value:r,name:"",id:"",onChange:n},c.a.createElement("option",{value:"",defaultChecked:!0},"All"),c.a.createElement("option",{value:"apartments"},"Apartments"),c.a.createElement("option",{value:"rooms"},"Rooms"),c.a.createElement("option",{value:"studios"},"Studios"),c.a.createElement("option",{value:"residences"},"Residences")),c.a.createElement("h3",{className:"main__filters-subtitle"},"Sort by price:"),c.a.createElement("select",{value:a,name:"",id:"",onChange:t},c.a.createElement("option",{value:"ascending",defaultChecked:!0},"Ascending"),c.a.createElement("option",{value:"descending"},"Descending")))}}]),t}(r.Component),v=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.property,t=e.photoUrls,a=e.title,n=e.pricePerMonth;return c.a.createElement("div",{className:"main__results-item-wrapper"},c.a.createElement("div",{className:"main__results-img"},c.a.createElement("img",{src:t.homecard,alt:a})),c.a.createElement("div",{className:"main__results-data"},c.a.createElement("div",{className:"main__results-description"},c.a.createElement("p",null,a)),c.a.createElement("div",{className:"main__results-side-wrapper"},c.a.createElement("h4",null,n,"\u20ac"),c.a.createElement("div",{className:"main__results-btn-wrapper"},c.a.createElement("button",{className:"btn btn--info"},"More details"),c.a.createElement("button",{className:"btn btn--success"},"Book now!")))))}}]),t}(r.Component),E=a(9),y=a.n(E),j=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"main__results-spinner"},c.a.createElement("img",{src:y.a,alt:"Cargando..."}))}}]),t}(r.Component),g=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.propertiesToPrint;return c.a.createElement("div",{className:"main__results"},e.length>0?c.a.createElement("ul",null,e.map(function(e,t){return c.a.createElement("li",{className:"main__results-item",key:t},c.a.createElement(v,{property:e}))})):c.a.createElement(j,null))}}]),t}(r.Component),O=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"main__results"},c.a.createElement("p",null,"Lo sentimos. Ha habido un error cargando datos."))}}]),t}(r.Component),P=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.propertiesToPrint,a=e.handleSelectPrice,n=e.sortPriceValue,r=e.handleSelectType,i=e.typeToFilter,o=e.errorInFetch;return c.a.createElement("main",{className:"main"},c.a.createElement(b,{handleSelectPrice:a,sortPriceValue:n,handleSelectType:r,typeToFilter:i}),!1===o?c.a.createElement(g,{propertiesToPrint:t}):c.a.createElement(O,null))}}]),t}(r.Component),_=[],S=[],T=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={propertiesToPrint:[],propertiesFetch:[],propertiesPriceAsc:[],propertiesPriceDesc:[],sortPriceValue:"ascending",typeToFilter:"",errorInFetch:!1},a.getLocation=a.getLocation.bind(Object(h.a)(a)),a.geoSuccess=a.geoSuccess.bind(Object(h.a)(a)),a.geoError=a.geoError.bind(Object(h.a)(a)),a.fetchData=a.fetchData.bind(Object(h.a)(a)),a.handleSelectPrice=a.handleSelectPrice.bind(Object(h.a)(a)),a.handleSelectType=a.handleSelectType.bind(Object(h.a)(a)),a.removePreviousData=a.removePreviousData.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getLocation()}},{key:"getLocation",value:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.geoSuccess,this.geoError):(alert("Geolocation is not supported by this browser."),this.fetchData())}},{key:"geoSuccess",value:function(e){var t=this,a=e.coords.latitude,r=e.coords.longitude;fetch("https://nominatim.openstreetmap.org/reverse?format=json&accept-language=es&lat=".concat(a,"&lon=").concat(r,"&zoom=10&addressdetails=1")).then(function(e){return e.json()}).then(function(e){return n=e.address.city.toLowerCase()}).then(function(){return t.fetchData()}).catch(function(e){console.log("Error: "+e),t.fetchData()})}},{key:"geoError",value:function(){alert("Geocoder failed."),this.fetchData()}},{key:"fetchData",value:function(){var e=this;console.log(this.state.typeToFilter),this.removePreviousData(),fetch("https://www.spotahome.com/api/public/listings/search/markers/".concat(n||"madrid","?type[]=").concat(this.state.typeToFilter)).then(function(e){return e.json()}).then(function(t){for(var a=t.data,n=0;n<30;n++)fetch("https://spotahome.com/api/public/listings/search/homecards_ids?ids%5B%5D=".concat(a[n].id,"&ids%5B%5D=").concat(a[n].id)).then(function(e){return e.json()}).then(function(t){_.push(t.data.homecards[0]),_.sort(function(e,t){return e.pricePerMonth-t.pricePerMonth}),(S=Object(s.a)(_)).sort(function(e,t){return t.pricePerMonth-e.pricePerMonth}),e.setState({propertiesToPrint:"descending"===e.state.sortPriceValue?S:_,propertiesFetch:_,propertiesPriceAsc:_,propertiesPriceDesc:S})}).catch(function(){return e.setState({errorInFetch:!0})})}).catch(function(){return e.setState({errorInFetch:!0})})}},{key:"handleSelectPrice",value:function(e){"ascending"===e.target.value?this.setState({propertiesToPrint:this.state.propertiesPriceAsc,sortPriceValue:"ascending"}):this.setState({propertiesToPrint:this.state.propertiesPriceDesc,sortPriceValue:"descending"})}},{key:"handleSelectType",value:function(e){var t=e.target.value;this.setState({typeToFilter:t},this.fetchData)}},{key:"removePreviousData",value:function(){_=[],S=[]}},{key:"render",value:function(){var e=this.state,t=e.propertiesToPrint,a=e.typeToFilter,n=e.errorInFetch,i=e.sortPriceValue;return c.a.createElement(r.Fragment,null,c.a.createElement(f,null),c.a.createElement(P,{propertiesToPrint:t,handleSelectPrice:this.handleSelectPrice,numberResults:30,handleSelectType:this.handleSelectType,typeToFilter:a,errorInFetch:n,sortPriceValue:i}))}}]),t}(r.Component);o.a.render(c.a.createElement(T,null),document.getElementById("root"))},9:function(e,t,a){e.exports=a.p+"static/media/spinner.cffa9d9d.gif"}},[[11,1,2]]]);
//# sourceMappingURL=main.b4f92ddf.chunk.js.map