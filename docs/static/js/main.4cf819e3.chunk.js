(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports=a(18)},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var r,n=a(0),i=a.n(n),c=a(8),s=a.n(c),o=(a(17),a(10)),l=a(1),u=a(2),p=a(5),h=a(3),m=a(6),d=a(4),f=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("header",{className:"header"},i.a.createElement("div",{className:"header__container"},i.a.createElement("div",{className:"header__logo"},i.a.createElement("h1",{className:"header__logo-title"},"Spot",i.a.createElement("span",null,"A"),"Room"),i.a.createElement("span",{className:"header__logo-subtitle"},"The best way to find your home")),i.a.createElement("nav",{className:"header__nav"},i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("a",{href:"#"},"The company")),i.a.createElement("li",null,i.a.createElement("a",{href:"#"},"How we work")),i.a.createElement("li",null,i.a.createElement("a",{href:"#"},"Contact us"))))))}}]),t}(n.Component),b=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSelectPrice,a=e.sortPriceValue,r=e.handleSelectType,n=e.typeToFilter,c=e.handleSelectNew,s=e.isNew;return i.a.createElement("div",{className:"main__filters"},i.a.createElement("h2",{className:"main__filters-title"},"Filters:"),i.a.createElement("h3",{className:"main__filters-subtitle"},"Property type:"),i.a.createElement("select",{value:n,name:"",id:"",onChange:r},i.a.createElement("option",{value:"",defaultChecked:!0},"All"),i.a.createElement("option",{value:"apartments"},"Apartments"),i.a.createElement("option",{value:"rooms"},"Rooms"),i.a.createElement("option",{value:"studios"},"Studios"),i.a.createElement("option",{value:"residences"},"Residences")),i.a.createElement("h3",{className:"main__filters-subtitle"},"Sort by price:"),i.a.createElement("select",{value:a,name:"",id:"",onChange:t},i.a.createElement("option",{value:"ascending",defaultChecked:!0},"Ascending"),i.a.createElement("option",{value:"descending"},"Descending")),i.a.createElement("h3",{className:"main__filters-subtitle"},"New property"),i.a.createElement("select",{value:s,name:"",id:"",onChange:c},i.a.createElement("option",{value:"",defaultChecked:!0},"All"),i.a.createElement("option",{value:!0},"New"),i.a.createElement("option",{value:!1},"Not new")))}}]),t}(n.Component),v=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.property,t=e.photoUrls,a=e.title,r=e.pricePerMonth;return i.a.createElement("div",{className:"main__results-item-wrapper"},i.a.createElement("div",{className:"main__results-img"},i.a.createElement("img",{src:t.homecard,alt:a})),i.a.createElement("div",{className:"main__results-data"},i.a.createElement("div",{className:"main__results-description"},i.a.createElement("p",null,a)),i.a.createElement("div",{className:"main__results-side-wrapper"},i.a.createElement("h4",null,r,"\u20ac"),i.a.createElement("div",{className:"main__results-btn-wrapper"},i.a.createElement("button",{className:"btn btn--info"},"More details"),i.a.createElement("button",{className:"btn btn--success"},"Book now!")))))}}]),t}(n.Component),E=a(9),g=a.n(E),P=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"main__results-spinner"},i.a.createElement("img",{src:g.a,alt:"Cargando..."}))}}]),t}(n.Component),y=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.propertiesToPrint;return i.a.createElement("div",{className:"main__results"},e.length>0?i.a.createElement("ul",null,e.map(function(e,t){return i.a.createElement("li",{className:"main__results-item",key:t},i.a.createElement(v,{property:e}))})):i.a.createElement(P,null))}}]),t}(n.Component),j=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"main__results"},i.a.createElement("p",null,"Lo sentimos. Ha habido un error cargando datos."))}}]),t}(n.Component),O=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.propertiesToPrint,a=e.handleSelectPrice,r=e.sortPriceValue,n=e.handleSelectType,c=e.typeToFilter,s=e.errorInFetch,o=e.handleSelectNew,l=e.isNew;return i.a.createElement("main",{className:"main"},i.a.createElement(b,{handleSelectPrice:a,sortPriceValue:r,handleSelectType:n,typeToFilter:c,handleSelectNew:o,isNew:l}),!1===s?i.a.createElement(y,{propertiesToPrint:t}):i.a.createElement(j,null))}}]),t}(n.Component),N=[],w=[],S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={propertiesToPrint:[],propertiesFetch:[],propertiesPriceAsc:[],propertiesPriceDesc:[],sortPriceValue:"ascending",typeToFilter:"",errorInFetch:!1,isNew:""},a.getLocation=a.getLocation.bind(Object(m.a)(a)),a.geoSuccess=a.geoSuccess.bind(Object(m.a)(a)),a.geoError=a.geoError.bind(Object(m.a)(a)),a.fetchData=a.fetchData.bind(Object(m.a)(a)),a.handleSelectPrice=a.handleSelectPrice.bind(Object(m.a)(a)),a.handleSelectType=a.handleSelectType.bind(Object(m.a)(a)),a.removePreviousData=a.removePreviousData.bind(Object(m.a)(a)),a.handleSelectNew=a.handleSelectNew.bind(Object(m.a)(a)),a.removePreviousFilter=a.removePreviousFilter.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getLocation()}},{key:"getLocation",value:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.geoSuccess,this.geoError):(alert("Geolocation is not supported by this browser."),this.fetchData())}},{key:"geoSuccess",value:function(e){var t=this,a=e.coords.latitude,n=e.coords.longitude;fetch("https://nominatim.openstreetmap.org/reverse?format=json&accept-language=es&lat=".concat(a,"&lon=").concat(n,"&zoom=10&addressdetails=1")).then(function(e){return e.json()}).then(function(e){return r=e.address.city.toLowerCase()}).then(function(){return t.fetchData()}).catch(function(e){console.log("Error: "+e),t.fetchData()})}},{key:"geoError",value:function(){alert("Geocoder failed."),this.fetchData()}},{key:"fetchData",value:function(){var e=this;console.log(this.state.typeToFilter),this.removePreviousData(),fetch("https://www.spotahome.com/api/public/listings/search/markers/".concat(r||"madrid","?type[]=").concat(this.state.typeToFilter)).then(function(e){return e.json()}).then(function(t){for(var a=t.data,r=0;r<30;r++)fetch("https://spotahome.com/api/public/listings/search/homecards_ids?ids%5B%5D=".concat(a[r].id,"&ids%5B%5D=").concat(a[r].id)).then(function(e){return e.json()}).then(function(t){N.push(t.data.homecards[0]),N.sort(function(e,t){return e.pricePerMonth-t.pricePerMonth}),(w=Object(o.a)(N)).sort(function(e,t){return t.pricePerMonth-e.pricePerMonth}),e.setState({propertiesToPrint:"descending"===e.state.sortPriceValue?w:N,propertiesFetch:N,propertiesPriceAsc:N,propertiesPriceDesc:w})}).catch(function(){return e.setState({errorInFetch:!0})})}).catch(function(){return e.setState({errorInFetch:!0})})}},{key:"handleSelectPrice",value:function(e){"ascending"===e.target.value?this.setState({propertiesToPrint:this.state.propertiesPriceAsc,sortPriceValue:"ascending"}):this.setState({propertiesToPrint:this.state.propertiesPriceDesc,sortPriceValue:"descending"})}},{key:"handleSelectType",value:function(e){var t=e.target.value;this.setState({typeToFilter:t},this.fetchData)}},{key:"removePreviousData",value:function(){N=[],w=[]}},{key:"handleSelectNew",value:function(e){var t=this;this.removePreviousFilter(),console.log(this.state.propertiesToPrint),"true"===e.target.value?(console.log("holi"),this.setState({isNew:!0,propertiesToPrint:this.state.propertiesToPrint.filter(function(e){return!0===e.isNew},function(){return console.log(t.state)})})):"false"===e.target.value?(console.log("adios"),this.setState({isNew:!1,propertiesToPrint:this.state.propertiesToPrint.filter(function(e){return!1===e.isNew},function(){return console.log(t.state)})})):this.setState({isNew:"",propertiesToPrint:"decending"===this.state.sortPriceValue?this.state.propertiesPriceDesc:this.state.propertiesPriceAsc})}},{key:"removePreviousFilter",value:function(){this.setState({propertiesToPrint:"decending"===this.state.sortPriceValue?this.state.propertiesPriceDesc:this.state.propertiesPriceAsc})}},{key:"render",value:function(){var e=this.state,t=e.propertiesToPrint,a=e.typeToFilter,r=e.errorInFetch,c=e.sortPriceValue,s=e.isNew;return i.a.createElement(n.Fragment,null,i.a.createElement(f,null),i.a.createElement(O,{propertiesToPrint:t,handleSelectPrice:this.handleSelectPrice,numberResults:30,handleSelectType:this.handleSelectType,typeToFilter:a,errorInFetch:r,sortPriceValue:c,handleSelectNew:this.handleSelectNew,isNew:s}))}}]),t}(n.Component);s.a.render(i.a.createElement(S,null),document.getElementById("root"))},9:function(e,t,a){e.exports=a.p+"static/media/spinner.cffa9d9d.gif"}},[[11,1,2]]]);
//# sourceMappingURL=main.4cf819e3.chunk.js.map