(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports=a(18)},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(8),i=a.n(c),o=(a(17),a(10)),s=a(1),l=a(2),u=a(5),p=a(3),m=a(6),h=a(4),d=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"header__container"},r.a.createElement("div",{className:"header__logo"},r.a.createElement("h1",{className:"header__logo-title"},"Spot",r.a.createElement("span",null,"A"),"Room"),r.a.createElement("span",{className:"header__logo-subtitle"},"The best way to find your home")),r.a.createElement("nav",{className:"header__nav"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{href:"#"},"The company")),r.a.createElement("li",null,r.a.createElement("a",{href:"#"},"How we work")),r.a.createElement("li",null,r.a.createElement("a",{href:"#"},"Contact us"))))))}}]),t}(n.Component),b=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSelectPrice,a=e.sortPriceValue,n=e.handleSelectType,c=e.typeToFilter;return r.a.createElement("div",{className:"main__filters"},r.a.createElement("h2",{className:"main__filters-title"},"Filters:"),r.a.createElement("h3",{className:"main__filters-subtitle"},"Property type:"),r.a.createElement("select",{value:c,name:"",id:"",onChange:n},r.a.createElement("option",{value:"",defaultChecked:!0},"All"),r.a.createElement("option",{value:"apartments"},"Apartments"),r.a.createElement("option",{value:"rooms"},"Rooms"),r.a.createElement("option",{value:"studios"},"Studios"),r.a.createElement("option",{value:"residences"},"Residences")),r.a.createElement("h3",{className:"main__filters-subtitle"},"Sort by price:"),r.a.createElement("select",{value:a,name:"",id:"",onChange:t},r.a.createElement("option",{value:"ascending",defaultChecked:!0},"Ascending"),r.a.createElement("option",{value:"descending"},"Descending")))}}]),t}(n.Component),f=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.property,t=e.photoUrls,a=e.title,n=e.pricePerMonth;return r.a.createElement("div",{className:"main__results-item-wrapper"},r.a.createElement("div",{className:"main__results-img"},r.a.createElement("img",{src:t.homecard,alt:a})),r.a.createElement("div",{className:"main__results-data"},r.a.createElement("div",{className:"main__results-description"},r.a.createElement("p",null,a)),r.a.createElement("div",{className:"main__results-side-wrapper"},r.a.createElement("h4",null,n,"\u20ac"),r.a.createElement("div",{className:"main__results-btn-wrapper"},r.a.createElement("button",{className:"btn btn--info"},"More details"),r.a.createElement("button",{className:"btn btn--success"},"Book now!")))))}}]),t}(n.Component),v=a(9),E=a.n(v),j=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"main__results-spinner"},r.a.createElement("img",{src:E.a,alt:"Cargando..."}))}}]),t}(n.Component),y=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.propertiesToPrint;return r.a.createElement("div",{className:"main__results"},e.length>0?r.a.createElement("ul",null,e.map(function(e,t){return r.a.createElement("li",{className:"main__results-item",key:t},r.a.createElement(f,{property:e}))})):r.a.createElement(j,null))}}]),t}(n.Component),g=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"main__results"},r.a.createElement("p",null,"Lo sentimos. Ha habido un error cargando datos."))}}]),t}(n.Component),O=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.propertiesToPrint,a=e.handleSelectPrice,n=e.sortPriceValue,c=e.handleSelectType,i=e.typeToFilter,o=e.errorInFetch;return r.a.createElement("main",{className:"main"},r.a.createElement(b,{handleSelectPrice:a,sortPriceValue:n,handleSelectType:c,typeToFilter:i}),!1===o?r.a.createElement(y,{propertiesToPrint:t}):r.a.createElement(g,null))}}]),t}(n.Component),P=[],_=[],S=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={propertiesToPrint:[],propertiesFetch:[],propertiesPriceAsc:[],propertiesPriceDesc:[],sortPriceValue:"ascending",typeToFilter:"",errorInFetch:!1},a.getLocation=a.getLocation.bind(Object(m.a)(a)),a.geoSuccess=a.geoSuccess.bind(Object(m.a)(a)),a.geoError=a.geoError.bind(Object(m.a)(a)),a.fetchData=a.fetchData.bind(Object(m.a)(a)),a.handleSelectPrice=a.handleSelectPrice.bind(Object(m.a)(a)),a.handleSelectType=a.handleSelectType.bind(Object(m.a)(a)),a.removePreviousData=a.removePreviousData.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getLocation()}},{key:"getLocation",value:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.geoSuccess,this.geoError):alert("Geolocation is not supported by this browser.")}},{key:"geoSuccess",value:function(e){var t=this,a=e.coords.latitude,n=e.coords.longitude;fetch("https://nominatim.openstreetmap.org/reverse?format=json&accept-language=es&lat=".concat(a,"&lon=").concat(n,"&zoom=10&addressdetails=1")).then(function(e){return e.json()}).then(function(e){return void 0===e.address.city.toLowerCase()}).then(function(){return t.fetchData()}).catch(function(e){return console.log("Error: "+e)})}},{key:"geoError",value:function(){alert("Geocoder failed.")}},{key:"fetchData",value:function(e){var t=this;this.removePreviousData(),fetch("https://www.spotahome.com/api/public/listings/search/markers/".concat("madrid").concat(e?"?type[]=".concat(this.state.typeToFilter):"")).then(function(e){return e.json()}).then(function(e){for(var a=e.data,n=0;n<30;n++)fetch("https://spotahome.com/api/public/listings/search/homecards_ids?ids%5B%5D=".concat(a[n].id,"&ids%5B%5D=").concat(a[n].id)).then(function(e){return e.json()}).then(function(e){P.push(e.data.homecards[0]),P.sort(function(e,t){return e.pricePerMonth-t.pricePerMonth}),(_=Object(o.a)(P)).sort(function(e,t){return t.pricePerMonth-e.pricePerMonth}),t.setState({propertiesToPrint:"descending"===t.state.sortPriceValue?_:P,propertiesFetch:P,propertiesPriceAsc:P,propertiesPriceDesc:_})}).catch(function(){return t.setState({errorInFetch:!0})})}).catch(function(){return t.setState({errorInFetch:!0})})}},{key:"handleSelectPrice",value:function(e){"ascending"===e.target.value?this.setState({propertiesToPrint:this.state.propertiesPriceAsc,sortPriceValue:"ascending"}):this.setState({propertiesToPrint:this.state.propertiesPriceDesc,sortPriceValue:"descending"})}},{key:"handleSelectType",value:function(e){var t=e.target.value;this.setState({typeToFilter:t},this.fetchData(t))}},{key:"removePreviousData",value:function(){P=[],_=[]}},{key:"render",value:function(){var e=this.state,t=e.propertiesToPrint,a=e.typeToFilter,c=e.errorInFetch;return r.a.createElement(n.Fragment,null,r.a.createElement(d,null),r.a.createElement(O,{propertiesToPrint:t,handleSelectPrice:this.handleSelectPrice,numberResults:30,handleSelectType:this.handleSelectType,typeToFilter:a,errorInFetch:c}))}}]),t}(n.Component);i.a.render(r.a.createElement(S,null),document.getElementById("root"))},9:function(e,t,a){e.exports=a.p+"static/media/spinner.cffa9d9d.gif"}},[[11,1,2]]]);
//# sourceMappingURL=main.483732af.chunk.js.map